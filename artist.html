<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>NEXTâ€™S YOU | Artist Studio</title>
    <style>
        :root {
            --sky-blue: #D0EFFF;
            --lavender: #E6D5FF;
            --art-purple: #A29BFE;
            --glass: rgba(255, 255, 255, 0.3);
            --glass-border: rgba(255, 255, 255, 0.5);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            margin: 0; font-family: -apple-system, sans-serif; 
            background: linear-gradient(160deg, var(--lavender) 0%, #FFFFFF 50%, var(--sky-blue) 100%);
            background-attachment: fixed; min-height: 100vh; color: #333;
        }

        .studio-header {
            padding: 50px 25px 30px; background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px); border-bottom: 1px solid var(--glass-border);
            border-radius: 0 0 35px 35px;
        }
        .studio-header h1 { margin: 0; font-size: 28px; font-weight: 900; color: var(--art-purple); }

        .glass-panel {
            background: var(--glass); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border); border-radius: 30px; padding: 25px; margin: 20px;
        }

        .tool-btn {
            width: 100%; padding: 18px; border-radius: 20px; border: none; margin-bottom: 12px;
            font-size: 16px; font-weight: bold; cursor: pointer; color: #fff; transition: 0.3s;
        }
        .btn-feed { background: linear-gradient(45deg, #A29BFE, #6C5CE7); }

        /* ç™¼æ–‡ç´€éŒ„æ¨£å¼ */
        .history-item {
            background: rgba(255,255,255,0.5); padding: 15px; border-radius: 15px;
            margin-bottom: 10px; border-left: 5px solid var(--art-purple);
        }
        .history-time { font-size: 10px; color: #aaa; margin-top: 5px; }

        .logout-btn { background: none; border: 1px solid #ddd; padding: 10px 25px; border-radius: 15px; color: #bbb; }
    </style>
</head>
<body>

    <header class="studio-header">
        <h1 id="artistTitle">Artist Studio</h1>
        <p>æ­¡è¿å›ä¾†ï¼Œ<span id="display-name">å‰µä½œè€…</span></p>
    </header>

    <div class="glass-panel">
        <h3 style="margin-top:0;">ğŸš€ å¿«é€Ÿå‰µä½œ</h3>
        <button class="tool-btn btn-feed" onclick="publishFeed()">âœï¸ æ’°å¯«æ–°å‹•æ…‹ (Feed)</button>
        <p style="font-size: 12px; color: #888;">ç™¼å¸ƒå¾Œï¼Œæ‰€æœ‰è¿½è¹¤æ‚¨çš„ç²‰çµ²å°‡æœƒæ”¶åˆ°é€šçŸ¥ã€‚</p>
    </div>

    <div class="glass-panel" id="history-panel">
        <h3 style="margin-top:0;">ğŸ“œ æœ€è¿‘ç™¼å¸ƒ</h3>
        <div id="feed-history">
            <p style="color:#999; font-size:14px;">å°šç„¡ç™¼å¸ƒç´€éŒ„</p>
        </div>
    </div>

    <div style="text-align: center; margin-bottom: 50px;">
        <button class="logout-btn" onclick="logout()">å®‰å…¨ç™»å‡º</button>
    </div>

<script>
    // å–å¾—ç•¶å‰è—äººèº«åˆ†
    const currentArtist = localStorage.getItem("user") || "è—äºº";

    window.onload = () => {
        if (localStorage.getItem("user_role") !== 'artist') {
            window.location.href = 'index.html';
        }
        document.getElementById('display-name').innerText = currentArtist;
        renderHistory();
    };

    function publishFeed() {
    const content = prompt("æƒ³å°ç²‰çµ²èªªé»ä»€éº¼ï¼Ÿ");
    if (content && content.trim() !== "") {
        // å¼·è‡´ä½¿ç”¨çµ±ä¸€çš„ Key: NEXTS_YOU_FEEDS
        let feeds = JSON.parse(localStorage.getItem("NEXTS_YOU_FEEDS") || "[]");
        
        const newPost = {
            id: Date.now(),
            artist: (localStorage.getItem("user") || "ARTIST").toUpperCase(),
            text: content,
            time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
        };

        feeds.unshift(newPost); 
        localStorage.setItem("NEXTS_YOU_FEEDS", JSON.stringify(feeds));
        
        alert("âœ… ç™¼å¸ƒæˆåŠŸï¼");
        renderHistory(); // é‡æ–°æ•´ç†è—äººè‡ªå·±çš„ç´€éŒ„
    }
}

    function renderHistory() {
        const container = document.getElementById('feed-history');
        const feeds = JSON.parse(localStorage.getItem("wv_feeds") || "[]");
        
        // åƒ…ç¯©é¸å±¬æ–¼ã€Œè‡ªå·±ã€çš„ç™¼æ–‡
        const myFeeds = feeds.filter(f => f.artist === currentArtist.toUpperCase());

        if (myFeeds.length === 0) {
            container.innerHTML = `<p style="color:#999; font-size:14px;">å°šç„¡ç™¼å¸ƒç´€éŒ„</p>`;
            return;
        }

        container.innerHTML = myFeeds.map(f => `
            <div class="history-item">
                <div style="font-size:14px;">${f.text}</div>
                <div class="history-time">${f.time} Â· å·²åŒæ­¥è‡³ç²‰çµ²ç«¯</div>
            </div>
        `).join('');
    }

    function logout() {
        localStorage.clear();
        window.location.href = 'index.html';
    }
</script>
</body>
</html>