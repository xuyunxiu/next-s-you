<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Weverse Professional Project</title>
    <style>
        /* --- æ ¸å¿ƒæ¨£å¼ (é»‘é‡‘è³ªæ„Ÿ) --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background-color: #000; color: #fff; margin: 0; font-family: -apple-system, sans-serif; overflow-x: hidden; }
        .view { display: none; min-height: 100vh; width: 100vw; }
        .active-view { display: block; }

        /* æ¨™é¡Œå€ */
        .step-header { padding: 60px 25px 20px; }
        .step-header h1 { font-size: 24px; font-weight: bold; margin: 0; }
        .step-header p { color: #888; font-size: 14px; margin-top: 8px; }

        /* 1. å¡ç‰‡ç‰† */
        .card-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 0 15px 150px; }
        .artist-card { 
            aspect-ratio: 1 / 1.25; border-radius: 20px; background-size: cover; background-position: center;
            position: relative; border: 2.5px solid transparent; transition: 0.2s; cursor: pointer;
        }
        .artist-card.selected { border-color: #fff; transform: scale(0.98); }
        .check-badge { 
            position: absolute; top: 10px; right: 10px; background: #fff; color: #000; 
            width: 20px; height: 20px; border-radius: 50%; text-align: center; 
            line-height: 20px; font-weight: bold; font-size: 11px; display: none;
        }
        .selected .check-badge { display: block; }
        .artist-name { position: absolute; bottom: 12px; left: 12px; font-weight: bold; z-index: 2; text-shadow: 0 2px 4px rgba(0,0,0,0.8); }

        /* 2. ä½¿ç”¨è€…è¨­å®š */
        .input-wrap { padding: 40px 20px; text-align: center; }
        .user-input { 
            width: 100%; padding: 18px; border-radius: 12px; border: 1px solid #333; 
            background: #111; color: #fff; font-size: 18px; text-align: center; outline: none;
        }

        /* 3. è€å±è‚¡é¦–é  */
        .home-nav { padding: 15px; text-align: center; font-weight: bold; border-bottom: 0.5px solid #222; font-size: 18px; position: sticky; top:0; background:#000; z-index:10; }
        .avatar-bar { display: flex; padding: 15px; gap: 12px; overflow-x: auto; border-bottom: 0.5px solid #111; }
        .avatar-bar::-webkit-scrollbar { display: none; }
        .circle-wrap { text-align: center; flex-shrink: 0; width: 65px; cursor: pointer; }
        .circle { width: 60px; height: 60px; border-radius: 50%; background: #222; border: 1px solid #333; overflow: hidden; display: flex; align-items: center; justify-content: center; margin-bottom: 5px; }
        .circle img { width: 100%; height: 100%; object-fit: cover; }
        .circle-name { font-size: 10px; color: #999; }

        /* 4. æ˜Ÿçƒå…§éƒ¨ */
        .planet-header { height: 220px; background-size: cover; background-position: center; position: relative; display: flex; align-items: flex-end; padding: 20px; }
        .planet-header::before { content: ''; position: absolute; top:0; left:0; width:100%; height:100%; background: linear-gradient(transparent, rgba(0,0,0,0.7)); }
        .back-btn { position: absolute; top: 40px; left: 20px; font-size: 30px; z-index: 10; cursor: pointer; }
        .planet-title { position: relative; font-size: 26px; font-weight: bold; z-index: 5; }
        .planet-tabs { display: flex; justify-content: space-around; padding: 15px; border-bottom: 0.5px solid #222; position: sticky; top:0; background:#000; z-index:10; }
        .tab { color: #888; font-weight: bold; padding-bottom: 8px; }
        .tab.active { color: #fff; border-bottom: 2px solid #fff; }

        /* å‹•æ…‹ Feed æ¨£å¼ */
        .feed-container { padding: 15px; padding-bottom: 100px; }
        .post-card { background: #111; border-radius: 15px; padding: 15px; margin-bottom: 15px; border: 0.5px solid #222; }
        .post-header { display: flex; align-items: center; margin-bottom: 10px; }
        .post-avatar { width: 40px; height: 40px; border-radius: 50%; margin-right: 10px; background: #333; }
        .post-author { font-weight: bold; font-size: 14px; }
        .post-time { font-size: 11px; color: #555; margin-left: auto; }
        .post-content { font-size: 14px; line-height: 1.5; color: #ccc; }

        /* åº•éƒ¨å›ºå®šæŒ‰éˆ• & å°èˆªåˆ— */
        .footer { position: fixed; bottom: 0; width: 100%; padding: 20px; background: linear-gradient(transparent, #000 40%); z-index: 100; }
        .btn-main { width: 100%; padding: 18px; border-radius: 35px; border: none; background: #333; color: #666; font-weight: bold; font-size: 16px; transition: 0.3s; }
        .btn-main.ready { background: #fff; color: #000; cursor: pointer; }
        .nav-bar { position: fixed; bottom: 0; width: 100%; height: 70px; background: #000; display: flex; justify-content: space-around; align-items: center; border-top: 0.5px solid #222; font-size: 22px; z-index: 20; }
        
        /* å½ˆçª—æ¨£å¼ */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; align-items: center; justify-content: center; }
        .modal-content { background: #111; width: 85%; padding: 25px; border-radius: 20px; text-align: center; }
    </style>
</head>
<body>

<div id="app">
    <section id="view-artist-select" class="view">
        <div class="step-header"><h1>é¸æ“‡æ„Ÿèˆˆè¶£çš„è—äºº</h1><p>è«‹å¤šé¸å¹¾å€‹å–œæ­¡çš„ç¤¾ç¾¤å§ï¼</p></div>
        <div class="card-grid" id="cardGrid"></div>
        <div class="footer"><button id="nextStepBtn" class="btn-main" onclick="toProfileStep()">ä¸‹ä¸€æ­¥</button></div>
    </section>

    <section id="view-profile-setup" class="view">
        <div class="step-header"><h1>è¨­å®šæ‚¨çš„ä½¿ç”¨è€…åç¨±</h1><p>é€™æ˜¯æ‚¨çš„å…¨çƒé¡¯ç¤ºåç¨±</p></div>
        <div class="input-wrap"><input type="text" id="nameInput" class="user-input" placeholder="è«‹è¼¸å…¥åç¨±" maxlength="15"></div>
        <div class="footer"><button class="btn-main ready" onclick="completeJoin()">é€²å…¥ Weverse</button></div>
    </section>

    <section id="view-home" class="view">
        <div class="home-nav">weverse</div>
        <div class="avatar-bar" id="avatarBar"></div>
        <main style="padding: 20px; text-align: center;">
            <p id="welcomeUser" style="color:#888"></p>
            <div id="homeFeed" class="feed-container">
                </div>
            <button onclick="clearAll()" style="background:none; border:1px solid #222; color:#333; padding:8px; border-radius:8px; margin-top:20px;">é‡ç½® App è³‡æ–™</button>
        </main>
        <nav class="nav-bar"><span>ğŸ </span><span>ğŸ’¬</span><span>ğŸ””</span><span>ğŸ‘¤</span></nav>
    </section>

    <section id="view-planet" class="view">
        <div class="back-btn" onclick="backToHome()">â€¹</div>
        <div id="planetHeader" class="planet-header"><div id="planetName" class="planet-title"></div></div>
        <div class="planet-tabs"><div class="tab active">Feed</div><div class="tab">Artist</div><div class="tab">Media</div></div>
        <div id="planetFeed" class="feed-container"></div>
    </section>

    <div id="nicknameModal" class="modal">
        <div class="modal-content">
            <h2>è¨­å®šç¤¾ç¾¤æš±ç¨±</h2>
            <p style="color:#888; font-size:14px;">åœ¨ <span id="targetPlanetName"></span> ä½¿ç”¨çš„æš±ç¨±</p>
            <input type="text" id="planetNicknameInput" class="user-input" placeholder="è¼¸å…¥ç¤¾ç¾¤æš±ç¨±">
            <button class="btn-main ready" style="margin-top:20px;" onclick="savePlanetNickname()">é–‹å§‹åŠ å…¥</button>
        </div>
    </div>
</div>

<script>
    // --- è—äºº & æ¨¡æ“¬è²¼æ–‡è³‡æ–™ ---
    const ARTIST_LIST = [
        { id: 1, name: "BLACKPINK", img: "https://placehold.co/100/ff69b4/fff?text=BP", card: "https://placehold.co/400x500/ff69b4/fff?text=BLACKPINK", posts: ["å¤§å®¶å¥½ï¼Œæˆ‘å€‘æ˜¯ BLACKPINKï¼", "æœŸå¾…èˆ‡å¤§å®¶è¦‹é¢ âœ¨", "æ–°å°ˆè¼¯æº–å‚™ä¸­..."] },
        { id: 2, name: "DREAMCATCHER", img: "https://placehold.co/100/4b0082/fff?text=DC", card: "https://placehold.co/400x500/4b0082/fff?text=DREAMCATCHER", posts: ["In the Frozen... â„ï¸", "ä»Šå¤©ä¹Ÿè¦åŠ æ²¹å–” Somniaï¼"] },
        { id: 3, name: "BABYMONSTER", img: "https://placehold.co/100/ff0000/fff?text=BM", card: "https://placehold.co/400x500/ff0000/fff?text=BABYMONSTER", posts: ["SHEESH! ğŸ¤˜", "ç·´ç¿’å®¤æ—¥å¸¸å…¬é–‹"] },
        { id: 4, name: "NCT DREAM", img: "https://placehold.co/100/adff2f/000?text=NCT", card: "https://placehold.co/400x500/adff2f/000?text=NCT+DREAM", posts: ["7DREAM æ°¸é åœ¨ä¸€èµ·ï¼", "YO DREAM!"] }
    ];

    let state = {
        tempSelected: [],
        currentPlanetId: null,
        nicknames: JSON.parse(localStorage.getItem("wv_nicknames") || "{}")
    };

    function show(id) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active-view'));
        document.getElementById(id).classList.add('active-view');
    }

    // --- æµç¨‹ 1 & 2 (è¨»å†Š) ---
    function renderCards() {
        const grid = document.getElementById('cardGrid');
        grid.innerHTML = ARTIST_LIST.map(a => `
            <div class="artist-card ${state.tempSelected.includes(a.id) ? 'selected' : ''}" onclick="toggleSelect(${a.id})" style="background-image: url('${a.card}')">
                <div class="check-badge">âœ“</div><div class="artist-name">${a.name}</div>
            </div>`).join('');
    }
    function toggleSelect(id) {
        const i = state.tempSelected.indexOf(id);
        if (i === -1) state.tempSelected.push(id); else state.tempSelected.splice(i, 1);
        const btn = document.getElementById('nextStepBtn');
        btn.classList.toggle('ready', state.tempSelected.length > 0);
        btn.innerText = state.tempSelected.length > 0 ? `åŠ å…¥ ${state.tempSelected.length} å€‹ç¤¾ç¾¤ï¼Œä¸‹ä¸€æ­¥` : "ä¸‹ä¸€æ­¥";
        renderCards();
    }
    function toProfileStep() { if (state.tempSelected.length > 0) show('view-profile-setup'); }
    function completeJoin() {
        const name = document.getElementById('nameInput').value.trim();
        if (!name) return alert("è«‹è¼¸å…¥åç¨±ï¼");
        localStorage.setItem("wv_user", name);
        localStorage.setItem("wv_groups", JSON.stringify(ARTIST_LIST.filter(a => state.tempSelected.includes(a.id))));
        startApp();
    }

    // --- æµç¨‹ 3 (é¦–é ) ---
    function startApp() {
        const name = localStorage.getItem("wv_user");
        if (!name) { show('view-artist-select'); renderCards(); return; }
        document.getElementById('welcomeUser').innerText = `Global ID: ${name}`;
        const groups = JSON.parse(localStorage.getItem("wv_groups") || "[]");
        const bar = document.getElementById('avatarBar');
        bar.innerHTML = `<div class="circle-wrap"><div class="circle" style="border:1px dashed #444">+</div><div class="circle-name">æ–°å¢</div></div>` + 
            groups.map(g => `<div class="circle-wrap" onclick="checkPlanetAccess(${g.id})"><div class="circle"><img src="${g.img}"></div><div class="circle-name">${g.name}</div></div>`).join('');
        show('view-home');
    }

    // --- æµç¨‹ 4 (æ˜Ÿçƒ & æš±ç¨±) ---
    function checkPlanetAccess(id) {
        state.currentPlanetId = id;
        const artist = ARTIST_LIST.find(a => a.id === id);
        if (!state.nicknames[id]) {
            document.getElementById('targetPlanetName').innerText = artist.name;
            document.getElementById('nicknameModal').style.display = 'flex';
        } else {
            openPlanet(id);
        }
    }

    function savePlanetNickname() {
        const nick = document.getElementById('planetNicknameInput').value.trim();
        if (!nick) return alert("è«‹è¼¸å…¥ç¤¾ç¾¤å°ˆå±¬æš±ç¨±ï¼");
        state.nicknames[state.currentPlanetId] = nick;
        localStorage.setItem("wv_nicknames", JSON.stringify(state.nicknames));
        document.getElementById('nicknameModal').style.display = 'none';
        openPlanet(state.currentPlanetId);
    }

    function openPlanet(id) {
        const artist = ARTIST_LIST.find(a => a.id === id);
        document.getElementById('planetName').innerText = artist.name;
        document.getElementById('planetHeader').style.backgroundImage = `url('${artist.card}')`;
        
        // æ¸²æŸ“å‹•æ…‹ Feed
        const feed = document.getElementById('planetFeed');
        feed.innerHTML = artist.posts.map(p => `
            <div class="post-card">
                <div class="post-header">
                    <div class="post-avatar"><img src="${artist.img}" style="width:100%; border-radius:50%;"></div>
                    <div><div class="post-author">${artist.name}</div><div class="post-time">å‰›å‰›</div></div>
                </div>
                <div class="post-content">${p}</div>
            </div>
        `).join('');
        
        show('view-planet');
    }

    function backToHome() { show('view-home'); }
    function clearAll() { if(confirm("ç¢ºå®šé‡ç½®ï¼Ÿ")) { localStorage.clear(); location.reload(); } }
    window.onload = startApp;
</script>
</body>
</html>
