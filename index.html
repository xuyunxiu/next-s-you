<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Login & Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border: rgba(255, 255, 255, 0.4);
            --primary-gradient: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%);
            --admin-red: #ff4757;
            --text-main: #2d3436;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: sans-serif; }
        body { background: #f0f2f5; height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        
        /* 背景 */
        .liquid-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%); }
        .blob { position: absolute; border-radius: 50%; filter: blur(60px); opacity: 0.6; animation: float 10s infinite; }
        .blob-1 { top: -10%; left: -10%; width: 60vw; height: 60vw; background: #a18cd1; }
        .blob-2 { bottom: -10%; right: -10%; width: 60vw; height: 60vw; background: #ff9a9e; animation-delay: -5s; }
        @keyframes float { 0%,100% { transform: translate(0,0); } 50% { transform: translate(20px, 40px); } }

        /* 卡片容器 */
        .container { width: 100%; max-width: 400px; padding: 20px; }
        
        /* 登入卡片 */
        .glass-card {
            background: rgba(255,255,255,0.4); backdrop-filter: blur(25px);
            border-radius: 24px; padding: 40px 30px; border: 1px solid var(--glass-border);
            box-shadow: 0 15px 35px rgba(0,0,0,0.05); text-align: center;
        }
        .logo { font-size: 42px; font-weight: 800; background: var(--primary-gradient); -webkit-background-clip: text; color: transparent; margin-bottom: 20px; }
        
        .input-group { position: relative; margin-bottom: 15px; }
        .input-group i { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #888; }
        input { width: 100%; padding: 15px 15px 15px 45px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.6); background: rgba(255,255,255,0.3); outline: none; transition: 0.3s; }
        input:focus { background: rgba(255,255,255,0.8); border-color: #a18cd1; }
        
        .btn { width: 100%; padding: 15px; border-radius: 12px; background: var(--primary-gradient); color: white; border: none; font-weight: 600; cursor: pointer; margin-top: 10px; }

        /* 管理員面板 (預設隱藏) */
        #admin-panel { display: none; text-align: left; }
        .admin-header { font-size: 18px; font-weight: bold; color: var(--admin-red); margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
        .db-item { background: white; padding: 10px; border-radius: 8px; margin-bottom: 8px; font-size: 12px; }
        .tag { padding: 2px 6px; border-radius: 4px; color: white; font-weight: bold; margin-right: 5px; }
        .tag-super { background: var(--admin-red); }
        .tag-artist { background: #a29bfe; }
        .tag-fan { background: #b2bec3; }
        
        .btn-outline { background: transparent; border: 1px solid var(--text-main); color: var(--text-main); margin-top: 5px; }
    </style>
</head>
<body>

    <div class="liquid-bg"><div class="blob blob-1"></div><div class="blob blob-2"></div></div>

    <div class="container">
        <div id="login-view" class="glass-card">
            <div class="logo">bubble</div>
            <form onsubmit="handleLogin(event)">
                <div class="input-group"><i class="ri-mail-line"></i><input id="email" type="email" placeholder="電子郵件" required></div>
                <div class="input-group"><i class="ri-lock-2-line"></i><input id="pwd" type="password" placeholder="密碼" required></div>
                <button type="submit" class="btn">登入</button>
            </form>
        </div>

        <div id="admin-panel" class="glass-card">
            <div class="admin-header">
                <i class="ri-shield-keyhole-fill"></i> 超級管理員後台
            </div>
            <div style="margin-bottom: 15px;">
                <p>歡迎回來, Admin!</p>
                <button class="btn" onclick="goToApp()">進入藝人聊天模式</button>
                <button class="btn btn-outline" onclick="logout()">登出</button>
            </div>
            <div style="max-height: 300px; overflow-y: auto;" id="user-list">
                </div>
        </div>
    </div>

    <script>
        // ==========================================
        // ⬇️ 資料庫 (由 index.html 統一管理) ⬇️
        // ==========================================
        const USER_DATABASE = {
            "admin@smtown.com": { pwd: "123", role: "artist", isSuperAdmin: true, name: "Karina (Admin)", avatar: "https://ui-avatars.com/api/?name=Karina&background=random&color=fff" },
            "partner@smtown.com": { pwd: "123", role: "artist", isSuperAdmin: true, name: "Winter (Admin)", avatar: "https://ui-avatars.com/api/?name=Winter&background=random&color=fff" },
            "ningning@smtown.com": { pwd: "123", role: "artist", isSuperAdmin: false, name: "NingNing", avatar: "https://ui-avatars.com/api/?name=NingNing&background=random&color=fff" },
            "fan@my.com": { pwd: "123", role: "fan", isSuperAdmin: false, name: "MY Fan", avatar: null }
        };

        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('email').value.trim();
            const pwd = document.getElementById('pwd').value.trim();
            const user = USER_DATABASE[email];

            if (user && user.pwd === pwd) {
                // 將使用者資訊存入 LocalStorage，讓其他頁面讀取
                user.email = email; // 補上 email
                localStorage.setItem('currentUser', JSON.stringify(user));

                if (user.isSuperAdmin) {
                    // 超級管理員：顯示後台
                    document.getElementById('login-view').style.display = 'none';
                    document.getElementById('admin-panel').style.display = 'block';
                    renderUserList();
                } else if (user.role === 'artist') {
                    // 普通藝人：直接跳轉
                    window.location.href = 'artist.html';
                } else {
                    // 粉絲：直接跳轉
                    window.location.href = 'fan.html';
                }
            } else {
                alert('帳號或密碼錯誤');
            }
        }

        function renderUserList() {
            const list = document.getElementById('user-list');
            list.innerHTML = '';
            for (const [email, u] of Object.entries(USER_DATABASE)) {
                let tag = `<span class="tag tag-fan">FAN</span>`;
                if(u.isSuperAdmin) tag = `<span class="tag tag-super">ADMIN</span>`;
                else if(u.role === 'artist') tag = `<span class="tag tag-artist">ARTIST</span>`;

                list.innerHTML += `
                    <div class="db-item">
                        <div>${tag} <b>${u.name}</b></div>
                        <div style="color:#666; margin-top:4px;">${email} / Pwd: ${u.pwd}</div>
                    </div>
                `;
            }
        }

        function goToApp() {
            window.location.href = 'artist.html';
        }

        function logout() {
            localStorage.removeItem('currentUser');
            location.reload();
        }
    </script>
</body>
</html>